<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="800" font-family="Segoe UI, Arial" font-size="14">
  <defs>
    <style>
      .box { fill:#ffffff; stroke:#333; stroke-width:2; rx:10; ry:10; }
      .title { font-weight:bold; }
      .note { fill:#555; }
      .link { stroke:#000; stroke-width:2; }
      .trunk { stroke-width:3; }
      .routed { stroke-width:4; }
      .span { stroke-dasharray:6 6; }
      .vlan { font-size:12; fill:#333; }
      .tag { font-size:12; fill:#fff; }
      .pill { fill:#777; stroke:#555; stroke-width:1; rx:6; ry:6; }
      .pill-red { fill:#c0392b; } .pill-blue{fill:#2980b9;} .pill-purple{fill:#8e44ad;}
      .pill-teal{fill:#1abc9c;} .pill-orange{fill:#e67e22;} .pill-green{fill:#27ae60;} .pill-gray{fill:#7f8c8d;}
    </style>
  </defs>

  <!-- Legend -->
  <g transform="translate(1020,30)">
    <text class="title">Legend</text>
    <g transform="translate(0,20)"><line x1="0" y1="0" x2="40" y2="0" class="link trunk"/><text x="50" y="5">Trunk</text></g>
    <g transform="translate(0,40)"><line x1="0" y1="0" x2="40" y2="0" class="link routed"/><text x="50" y="5">Routed /30</text></g>
    <g transform="translate(0,60)"><line x1="0" y1="0" x2="40" y2="0" class="link span"/><text x="50" y="5">SPAN</text></g>
    <g transform="translate(0,90)">
      <rect class="pill pill-gray" x="0" y="-14" width="50" height="20"/><text x="25" y="2" text-anchor="middle" class="tag">V99</text>
      <rect class="pill pill-red"  x="60" y="-14" width="50" height="20"/><text x="85" y="2" text-anchor="middle" class="tag">V10</text>
      <rect class="pill pill-blue" x="120" y="-14" width="50" height="20"/><text x="145" y="2" text-anchor="middle" class="tag">V20</text>
      <rect class="pill pill-purple" x="180" y="-14" width="50" height="20"/><text x="205" y="2" text-anchor="middle" class="tag">V30</text>
      <rect class="pill pill-teal" x="240" y="-14" width="50" height="20"/><text x="265" y="2" text-anchor="middle" class="tag">V40</text>
      <rect class="pill pill-orange" x="300" y="-14" width="50" height="20"/><text x="325" y="2" text-anchor="middle" class="tag">V50</text>
      <rect class="pill pill-green" x="360" y="-14" width="50" height="20"/><text x="385" y="2" text-anchor="middle" class="tag">V60</text>
    </g>
  </g>

  <!-- Devices -->
  <!-- Edge / pfSense -->
  <g transform="translate(200,80)">
    <rect class="box" width="180" height="70"/><text x="90" y="25" text-anchor="middle" class="title">pfSense</text>
    <text x="90" y="48" text-anchor="middle" class="note">IDS / VPN / PBR</text>
  </g>
  <g transform="translate(200,200)">
    <rect class="box" width="220" height="90"/><text x="110" y="28" text-anchor="middle" class="title">EDGE-ISR4331</text>
    <text x="15" y="55" class="note">Gi0/0/0: WAN (outside)</text>
    <text x="15" y="75" class="note">Gi0/0/1: 10.0.0.1/30</text>
  </g>

  <!-- Core -->
  <g transform="translate(560,220)">
    <rect class="box" width="260" height="120"/><text x="130" y="28" text-anchor="middle" class="title">CORE-3850E</text>
    <text x="15" y="55" class="note">SVIs: V10/20/30/40/50/60/99</text>
    <text x="15" y="75" class="note">Gi1/0/24: 10.0.0.2/30</text>
    <text x="15" y="95" class="note">Gi1/0/23: SPAN dest</text>
  </g>

  <!-- Access -->
  <g transform="translate(520,430)">
    <rect class="box" width="200" height="90"/><text x="100" y="28" text-anchor="middle" class="title">ACCESS-2960X</text>
    <text x="10" y="55" class="note">Gi1/0/24 trunk → Core</text>
  </g>
  <g transform="translate(800,430)">
    <rect class="box" width="200" height="90"/><text x="100" y="28" text-anchor="middle" class="title">ACCESS-2960S</text>
    <text x="10" y="55" class="note">Gi1/0/24 trunk → Core</text>
  </g>

  <!-- Hosts -->
  <g transform="translate(1100,430)">
    <rect class="box" width="220" height="90"/><text x="110" y="28" text-anchor="middle" class="title">Servers / Proxmox</text>
    <text x="110" y="55" text-anchor="middle" class="note">VLAN10 / Mgmt99</text>
  </g>
  <g transform="translate(520,560)">
    <rect class="box" width="200" height="70"/><text x="100" y="28" text-anchor="middle" class="title">AP-01</text>
    <text x="100" y="50" text-anchor="middle" class="note">Trunk native 99</text>
  </g>
  <g transform="translate(800,560)">
    <rect class="box" width="200" height="70"/><text x="100" y="28" text-anchor="middle" class="title">HONEYPOT / IoT</text>
    <text x="100" y="50" text-anchor="middle" class="note">VLAN50</text>
  </g>
  <g transform="translate(560,90)">
    <rect class="box" width="260" height="70"/><text x="130" y="28" text-anchor="middle" class="title">SENSOR-01</text>
    <text x="130" y="50" text-anchor="middle" class="note">SPAN from VLAN50</text>
  </g>

  <!-- Links -->
  <!-- Core <-> Edge (/30) -->
  <line x1="470" y1="265" x2="560" y2="280" class="link routed"/>
  <text x="515" y="260" text-anchor="middle" class="vlan">/30 10.0.0.2 ↔ 10.0.0.1</text>

  <!-- Edge block: pfSense to ISR (optional PBR arrow) -->
  <line x1="290" y1="150" x2="310" y2="200" class="link"/>
  <text x="315" y="168" class="vlan">Transit / PBR (opt)</text>

  <!-- Core to Access trunks -->
  <line x1="640" y1="340" x2="620" y2="430" class="link trunk"/>
  <text x="610" y="395" class="vlan">Trunk 10,20,30,40,50,60,99</text>

  <line x1="780" y1="340" x2="900" y2="430" class="link trunk"/>
  <text x="855" y="395" class="vlan">Trunk 30,50,99</text>

  <!-- Access to endpoints -->
  <line x1="620" y1="520" x2="620" y2="560" class="link"/>
  <line x1="900" y1="520" x2="900" y2="560" class="link"/>

  <!-- Core SPAN to Sensor -->
  <line x1="690" y1="220" x2="690" y2="160" class="link span"/>
  <text x="710" y="190" class="vlan">SPAN (V50 both) → Gi1/0/23</text>

  <!-- Servers (connected upstream via Core/Access in practice) -->
  <line x1="1000" y1="470" x2="1100" y2="475" class="link"/>
  <text x="1050" y="460" class="vlan">Mgmt99 / VLAN10</text>

  <!-- Title block -->
  <text x="30" y="30" class="title">Dooley SIEM Lab — NETWORK-TOPOLOGY-v1</text>
  <text x="30" y="50" class="note">Edge: ISR4331 • Core: 3850-E • Access: 2960X/2960S • pfSense sidecar • SPAN to Sensor</text>
</svg>
